{{!
  This file is part of Moodle - http://moodle.org/

  Moodle is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Moodle is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
  @template mod_moodleoverflow/discussion_list

  Moodleoverflow discussion_list template.
  The purpose of this template is to render a list of discussions for the view.php.

  Example context (json):
  {
  }
}}

{{! There are no discussions. Print the string that specifies it. }}
{{^hasdiscussions}}
    <div class="moodleoverflowdiscussions">
        ( {{#str}} nodiscussions, moodleoverflow {{/str}} )
    </div>
{{/hasdiscussions}}

{{! There are discussions. Start to print the table. }}
{{#hasdiscussions}}

    <table cellspacing="0" class="moodleoverflowheaderlist">

        {{! Print the heading row of the table. }}
        <thead>
            <tr>

               

                <th class="header replies" scope="col">
                    {{#str}} headervotes, moodleoverflow {{/str}}
                </th>



                {{! Check if the user is allowed to view the discussions. }}
                {{#canviewdiscussions}}
                    
                    <th class="header replies" scope="col">
                        {{#str}} headerreplies, moodleoverflow {{/str}}
                    </th>

                    {{! Display the unread column if the moodleoverflow can be tracked. }}
                    {{#cantrack}}
                        
                    {{/cantrack}}
                {{/canviewdiscussions}}

                <th class="header topic" scope="col">
                    {{#str}} headerdiscussion, moodleoverflow {{/str}}
                </th>
                <th class="header author" colspan="2" scope="col">
                    {{#str}} headerstartedby, moodleoverflow {{/str}}
                </th>

                <th class="header lastpost" scope="col">
                    {{#str}} headerlastpost, moodleoverflow {{/str}}
                </th>

                {{#cansubtodiscussion}}
                <th class="header discussionsubscription" scope="col">
                    <span class="preload-subscribe">&nbsp;</span>
                    <span class="preload-unsubscribe">&nbsp;</span>
                </th>
                {{/cansubtodiscussion}}

            </tr>
        </thead>

        {{! Print the body of the discussion. }}
        <tbody>

        {{! Loop through all discussions. }}
        {{#discussions}}
            <tr class="discussion r{{ rowcount }}">

                {{! The status of the discussion. }}
                <td class="topic replies">
                 

                {{! The votes of the discussion. }}
                <td class="topic replies">
                    <a href="{{ subjectlink }}">{{ votes }}</a>
                </td>

                {{! Show the reply-columns only if the user has the capability to do so. }}
                {{#canviewdiscussions}}

                         <td class="replies">
                        <a href="{{ subjectlink }}">{{ replyamount }}</a>
                    </td>
                    {{#cantrack}}

                        <td class="replies">

                            {{! This moodleoverflow instance is not tracked. }}
                            {{^istracked}}
                                <span class="read">-</span>
                            {{/istracked}}

                            {{! This moodleoverflow instance is tracked. }}
                            {{#istracked}}

                            {{! There are unread messages }}
                                

                            {{/istracked}}

                        </td>

                    {{/cantrack}}

                {{/canviewdiscussions}}

                <td class="topic starter">
                    <a href="{{ subjectlink }}">{{ subjecttext }}</a>
                </td>

                <td class="picture">
                    {{{ picture }}}
                </td>

                <td class="author">
                    <a href="{{ userlink }}">{{ username }}</a>
                </td>

                <td class="lastpost">
                    <a href="{{ lastpostuserlink }}">{{ lastpostusername }}</a> <br />
                    <a href="{{ lastpostlink }}">{{ lastpostdate }}</a>
                </td>

                {{#cansubtodiscussion}}
                    <td class="discussionsubscription">{{{discussionsubicon}}}</td>
                {{/cansubtodiscussion}}

            </tr>

        {{/discussions}}

        </tbody>

    </table>

{{/hasdiscussions}}
